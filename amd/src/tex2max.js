!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.tex2max=r():e.tex2max=r()}(window,function(){return function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(t,o,function(r){return e[r]}.bind(null,o));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=20)}([function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.warn=function(e){t&&console.warn(e)};var t=!0;r.debug=function(e){0}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.transpiler=function(e){c.debug("\n------------------ TRANSPILING -> -------------------");var r=(0,v.getOptions)();var n="";var g=0;n+="(";var b=function(){var v=e[g];switch(v.type){case"operator":!function(){var r=e[g-1];if(0!==g||"+"!==v.value&&"*"!==v.value){if(0===g&&"prefix"!==v.operatorType&&"-"!==v.value)throw new Error("Operator "+v.value+" is not an prefix operator");if("+"===v.value||"-"===v.value)n+=v.value;else if("postfix"===v.operatorType){if("operator"===r.type)throw new Error("Operator "+v.value+" has to be an postfix operator");n+=v.value}else if("prefix"===v.operatorType);else if("infix"===v.operatorType){if("operator"===r.type||"operator"===r.type)throw new Error("Operator "+v.value+" has to be an infix operator");n+=v.value}}else c.debug("Structure starts with * or +, ignoring");if(("infix"===v.operatorType||"prefix"===v.operatorType)&&g===e.length-1)throw new Error("Operator "+v.value+" is an invalid end character in "+n.substring(1))}();break;case"number":b(g,{type:"number"},{type:"operator",operatorType:"infix"}),n+=v.value;break;case"variable":!function(){var e="";if(b(g,{type:"operator",operatorType:"infix"}),null!==(0,p.getName)(v.value)){var t=(0,p.getName)(v.value);r.onlyGreekSymbol&&(t=(0,p.getSymbol)(t)),c.debug("greek letter "+t),e+=t}else e+=v.value;n+=e}();break;case"group":b(g,{type:"function"},{type:"operator"}),n+=d(v.value);break;case"token":!function(){c.debug("Handling token: "+v.value);var t="",o=g;if(null!==(0,p.getSymbol)(v.value)){var i=v.value;r.onlyGreekSymbol&&(i=(0,p.getSymbol)(i)),c.debug("greek letter "+i),t+=i}if(null!==(0,p.getName)(v.value)){var u=v.value;r.onlyGreekName&&(u=(0,p.getName)(u)),c.debug("greek letter "+u),t+=u}if((0,a.isMacro)(v.value)){var l=a.MACROS.get(v.value);null===l?c.debug("Skipping macro "+v.value):void 0!==l&&(c.debug("Adding macro "+l),t+=l)}if("frac"===v.value){if("group"!==e[g+1].type||"group"!==e[g+2].type)throw new Error("Fraction must have 2 following parameters");c.debug("Found fraction"),t+=d(e[g+1].value)+"/"+d(e[g+2].value),g+=2}o>0&&""!==t&&((0,a.isMacro)(v.value)||(0,p.isGreekLetter)(v.value))&&b(o,{type:"operator"});n+=t}();break;case"function":!function(){b(g,{type:"operator"});var r=e[g+1];if("sqrt"===v.value){if("group"!==e[g+1].type)throw new Error("Square root must be followed by [] or {}");var t="";if("square"===e[g+1].symbol&&"group"===e[g+2].type){c.debug("Found function nth-square root");var a=d(e[g+1].value);t+=d(e[g+2].value),t+="^(1/"+a+")",g++}else n+=v.value,c.debug("Found function square root"),t+=d(e[g+1].value);n+=t,g++}else"lim"===v.value?(c.debug("Found function limit"),function(){var r="",t="";if("_"!==e[g+1].value||"group"!==e[g+2].type)throw new Error('Limit must have a "from" and "to" value');var a=e[g+2].value;if(a=(0,f.handleLimitArguments)(a),"group"===e[g+3].type)t+=d(e[g+3].value);else{var i=(0,o.getLimitLength)(e.slice(g+3));t+=d(e.slice(g+3,g+3+i)),g+=i-1}r=(0,u.buildMaximaFunctionString)("limit",t,a.variable,a.value,a.direction),g+=3;n+=r}()):"binom"===v.value?(c.debug("Found function binomial"),function(){var r="",t="",o="",a=e[g+1].type,i=e[g+2].type;if("group"!==a||"group"!==i)throw new Error("Binomial must have 2 following groups");t+=d(e[g+1].value),o+=d(e[g+2].value);r+=(0,u.buildMaximaFunctionString)("binomial",t,o),n+=r,g+=2}()):"sum"===v.value?(c.debug("Found function binomial"),function(){var r="",t="",a=void 0,i=void 0,l="";if("_"!==e[g+1].value&&"^"!==e[g+1].value)throw new Error("Sum does not contain the correct number of arguments");var f=(0,s.handleUpperAndLowerArgsSum)(e.slice(g+1)),v=f.lowerLimit.value;i=f.upperLimit,g+=4,v=(0,s.handleLowerSumArguments)(v),l=v.variable,a=v.value,c.debug("Sum: arguments are form "+a+" to "+i);var p=(0,o.getLimitLength)(e.slice(g+1));t+=d(e.slice(g+1,g+1+p)),g+=p,r+=(0,u.buildMaximaFunctionString)("sum",t,l,a,i),n+=r}()):"integral"===v.value?(c.debug("Found function integral"),function(){var r="",t="",o=void 0,a=void 0,i="",s=void 0,f=!1;if("_"!==e[g+1].value&&"^"!==e[g+1].value)c.debug("Integral is symbolic"),f=!0,g++;else{var v=e.slice(g+1,g+5),p=(0,l.handleUpperAndLowerArgs)(v);o=p.lowerLimit,a=p.upperLimit,c.debug("Integration limits are from "+o+" to "+a),g+=5}var b=(0,l.findIntegralEnd)(e.slice(g));i+=b.variable,s=b.length;var m=e.slice(g,g+s);"*"===m[m.length-1].value&&m.splice(-1,1);t+=d(m),g+=s,r+=f?(0,u.buildMaximaFunctionString)("integrate",t,i):(0,u.buildMaximaFunctionString)("integrate",t,i,o,a);n+=r}()):"number"===r.type||"variable"===r.type?(c.debug("Found literal function"),n+=v.value,n+="(",n+=r.value,n+=")",g++):n+=v.value}();break;case"environment":!function(){if("begin"===v.state){b(g,{type:"operator"});var r="",o=(0,t.environmentLength)(e.slice(g));"matrix"===v.value&&(c.debug("Found matrix environment"),r+=(0,i.handleMatrix)(e.slice(g+1,g+1+o))),g+=o+1,n+=r}else"end"===v.state&&g++}()}function b(t){var o=e[t-1],a=!0;if(t>0){for(var i=arguments.length,u=Array(i>1?i-1:0),l=1;l<i;l++)u[l-1]=arguments[l];u.forEach(function(e){var r=!0;for(var n in e)e.hasOwnProperty(n)&&o[n]!==e[n]&&(r=!1);!0===r&&(a=!1)}),r.addTimesSign&&a&&(c.debug("Adding * before "+v.type+": "+v.value+", previous item: "+e[t-1].type),n+="*")}}};for(;g<e.length;g++)b();n+=")";if(/(\([ ]*\))/.test(n))throw new Error("Syntax error");if(""===n)throw new Error("EMPTY");return n};var t=n(12),o=n(11),a=n(6),i=n(10),u=n(2),l=n(9),s=n(8),f=n(7),v=n(5),c=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0)),p=n(3);function d(e){c.debug("\n------------------ TRANSPILING -> -------------------");var r=(0,v.getOptions)();var n="";var g=0;n+="(";var b=function v(){var b=e[g];switch(b.type){case"operator":h();break;case"number":E();break;case"variable":w();break;case"group":S();break;case"token":O();break;case"function":_();break;case"environment":T();break}function m(){return n.substring(1)}function y(t){var o=e[t-1];var a=true;if(t>0){for(var i=arguments.length,u=Array(i>1?i-1:0),l=1;l<i;l++){u[l-1]=arguments[l]}u.forEach(function(e){var r=true;for(var n in e){if(!e.hasOwnProperty(n)){continue}if(o[n]!==e[n]){r=false}}if(r===true)a=false});if(r.addTimesSign&&a){c.debug("Adding * before "+b.type+": "+b.value+", previous item: "+e[t-1].type);n+="*"}}}function h(){var r=e[g-1];if(g===0&&(b.value==="+"||b.value==="*")){c.debug("Structure starts with * or +, ignoring")}else if(g===0&&b.operatorType!=="prefix"&&b.value!=="-"){throw new Error("Operator "+b.value+" is not an prefix operator")}else{if(b.value==="+"||b.value==="-"){n+=b.value}else if(b.operatorType==="postfix"){if(r.type!=="operator"){n+=b.value}else{throw new Error("Operator "+b.value+" has to be an postfix operator")}}else if(b.operatorType==="prefix"){}else if(b.operatorType==="infix"){if(r.type!=="operator"&&r.type!=="operator"){n+=b.value}else{throw new Error("Operator "+b.value+" has to be an infix operator")}}}if((b.operatorType==="infix"||b.operatorType==="prefix")&&g===e.length-1){throw new Error("Operator "+b.value+" is an invalid end character in "+m())}}function E(){y(g,{type:"number"},{type:"operator",operatorType:"infix"}),n+=b.value}function w(){var e="";if(y(g,{type:"operator",operatorType:"infix"}),null!==(0,p.getName)(b.value)){var t=(0,p.getName)(b.value);if(r.onlyGreekSymbol){t=(0,p.getSymbol)(t)}c.debug("greek letter "+t);e+=t}else{e+=b.value}n+=e}function S(){y(g,{type:"function"},{type:"operator"}),n+=d(b.value)}function O(){c.debug("Handling token: "+b.value);var t="",o=g;if((0,p.getSymbol)(b.value)!==null){var i=b.value;if(r.onlyGreekSymbol){i=(0,p.getSymbol)(i)}c.debug("greek letter "+i);t+=i}if((0,p.getName)(b.value)!==null){var u=b.value;if(r.onlyGreekName){u=(0,p.getName)(u)}c.debug("greek letter "+u);t+=u}if((0,a.isMacro)(b.value)){var l=a.MACROS.get(b.value);if(l===null){c.debug("Skipping macro "+b.value)}else if(l!==undefined){c.debug("Adding macro "+l);t+=l}}if(b.value==="frac"){if(e[g+1].type==="group"&&e[g+2].type==="group"){c.debug("Found fraction");t+=d(e[g+1].value)+"/"+d(e[g+2].value);g+=2}else{throw new Error("Fraction must have 2 following parameters")}}if(o>0&&t!==""&&((0,a.isMacro)(b.value)||(0,p.isGreekLetter)(b.value))){y(o,{type:"operator"})}n+=t}function _(){y(g,{type:"operator"});var r=e[g+1];if(b.value==="sqrt"){if(e[g+1].type==="group"){var t="";if(e[g+1].symbol==="square"&&e[g+2].type==="group"){c.debug("Found function nth-square root");var a=d(e[g+1].value);t+=d(e[g+2].value);t+="^(1/"+a+")";g++}else{n+=b.value;c.debug("Found function square root");t+=d(e[g+1].value)}n+=t;g++}else{throw new Error("Square root must be followed by [] or {}")}}else if(b.value==="lim"){c.debug("Found function limit");v()}else if(b.value==="binom"){c.debug("Found function binomial");i()}else if(b.value==="sum"){c.debug("Found function binomial");p()}else if(b.value==="integral"){c.debug("Found function integral");m()}else if(r.type==="number"||r.type==="variable"){c.debug("Found literal function");n+=b.value;n+="(";n+=r.value;n+=")";g++}else{n+=b.value}function i(){var r="",t="",o="",a=e[g+1].type,i=e[g+2].type;if(a==="group"&&i==="group"){t+=d(e[g+1].value);o+=d(e[g+2].value)}else{throw new Error("Binomial must have 2 following groups")}r+=(0,u.buildMaximaFunctionString)("binomial",t,o),n+=r,g+=2}function v(){var r="",t="";if(e[g+1].value==="_"&&e[g+2].type==="group"){var a=e[g+2].value;a=(0,f.handleLimitArguments)(a);if(e[g+3].type==="group"){t+=d(e[g+3].value)}else{var i=(0,o.getLimitLength)(e.slice(g+3));t+=d(e.slice(g+3,g+3+i));g+=i-1}r=(0,u.buildMaximaFunctionString)("limit",t,a.variable,a.value,a.direction);g+=3}else{throw new Error('Limit must have a "from" and "to" value')}n+=r}function p(){var r="",t="",a=void 0,i=void 0,l="";if(e[g+1].value!=="_"&&e[g+1].value!=="^"){throw new Error("Sum does not contain the correct number of arguments")}else{var f=(0,s.handleUpperAndLowerArgsSum)(e.slice(g+1));var v=f.lowerLimit.value;i=f.upperLimit;g+=4;v=(0,s.handleLowerSumArguments)(v);l=v.variable;a=v.value;c.debug("Sum: arguments are form "+a+" to "+i)}var p=(0,o.getLimitLength)(e.slice(g+1));t+=d(e.slice(g+1,g+1+p)),g+=p,r+=(0,u.buildMaximaFunctionString)("sum",t,l,a,i),n+=r}function m(){var r="",t="",o=void 0,a=void 0,i="",s=void 0,f=false;if(e[g+1].value!=="_"&&e[g+1].value!=="^"){c.debug("Integral is symbolic");f=true;g++}else{var v=e.slice(g+1,g+5);var p=(0,l.handleUpperAndLowerArgs)(v);o=p.lowerLimit;a=p.upperLimit;c.debug("Integration limits are from "+o+" to "+a);g+=5}var b=(0,l.findIntegralEnd)(e.slice(g));i+=b.variable,s=b.length;var m=e.slice(g,g+s);if(m[m.length-1].value==="*"){m.splice(-1,1)}if(t+=d(m),g+=s,f){r+=(0,u.buildMaximaFunctionString)("integrate",t,i)}else{r+=(0,u.buildMaximaFunctionString)("integrate",t,i,o,a)}n+=r}}function T(){if(b.state==="begin"){y(g,{type:"operator"});var r="";var o=(0,t.environmentLength)(e.slice(g));if(b.value==="matrix"){c.debug("Found matrix environment");r+=(0,i.handleMatrix)(e.slice(g+1,g+1+o))}g+=o+1;n+=r}else if(b.state==="end"){g++}}};for(g;g<e.length;g++){b()}n+=")";if(/(\([ ]*\))/.test(n)){throw new Error("Syntax error")}if(n==="")throw new Error("EMPTY");return n}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isEquation=function(e){var r=0;if(e.forEach(function(e){"operator"===e.type&&"="===e.value&&r++}),1===r)return!0;if(r>1)throw new Error("Expression contains more than one equal signs");return!1},r.checkForVariable=function e(r){t.debug("Checking expression "+JSON.stringify(r)+" for variable");var n=!1;if(Array.isArray(r))for(var o=0;o<r.length;o++)if("group"===r[o].type){var a=e(r[o].value);a&&(n=!0)}else"variable"===r[o].type&&(n=!0);else n="variable"===r.type;return n},r.buildMaximaFunctionString=function(e,r){var n="";n+=e+"("+r;for(var t=arguments.length,o=Array(t>2?t-2:0),a=2;a<t;a++)o[a-2]=arguments[a];return o.forEach(function(e){!1!==e&&null!==e&&void 0!==e&&(n+=","+e)}),n+=")"},r.searchForOccurrence=function e(r,n,t,o){var a=!1;var i=!1;var u=[];if(Array.isArray(r))for(var l=0;l<r.length;l++)if("group"===r[l].type&&o){var s=void 0;"type"===n?(s=e(r[l].type,"type",t,!0),i=s.isPresent):"value"===n&&(s=e(r[l].value,"value",t,!0),i=s.isPresent),i&&(u.push(s.position),a=!0)}else"type"===n?r[l].type===t&&(a=!0,u.push(l)):"value"===n&&r[l].value===t&&(a=!0,u.push(l));else"type"===n?r.type===t&&(a=!0,u=0):"value"===n?r.value===t&&(a=!0,u=null):a=!1;var f={isPresent:a,position:u};return f},r.stripParenthesis=function(e){return e.substr(1,e.length-2)};var t=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.letters=void 0,r.toUpperCase=a,r.isUpperCase=i,r.getSymbol=function(e){var r=o.find(function(r){return r.name===e.toLowerCase()});if(void 0===r)return null;r=r.symbol,i(e)&&(r=a(r));return r},r.getName=function(e){var r=o.find(function(r){return r.symbol===e.toLowerCase()});if(void 0===r)return null;r=r.name,i(e)&&(r=a(r));return r},r.isGreekLetter=function(e){var r=o.find(function(r){return r.name===e.toLowerCase()}),n=o.find(function(r){return r.symbol===e.toLowerCase()});return void 0!==r||void 0!==n},r.convertSymbols=function(e){return t.debug("Converting math symbols "+e),o.forEach(function(r){e=(e=e.split(r.symbol).join(r.name)).split(a(r.symbol)).join(a(r.name))}),t.debug("- Converted math symbols "+e),e};var t=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0));var o=r.letters=[{name:"alpha",symbol:"α"},{name:"beta",symbol:"β"},{name:"gamma",symbol:"γ"},{name:"delta",symbol:"δ"},{name:"epsilon",symbol:"ϵ"},{name:"zeta",symbol:"ζ"},{name:"eta",symbol:"η"},{name:"theta",symbol:"θ"},{name:"iota",symbol:"ι"},{name:"kappa",symbol:"κ"},{name:"lambda",symbol:"λ"},{name:"mu",symbol:"μ"},{name:"nu",symbol:"ν"},{name:"omicron",symbol:"ο"},{name:"pi",symbol:"π"},{name:"rho",symbol:"ρ"},{name:"sigma",symbol:"σ"},{name:"tau",symbol:"τ"},{name:"upsilon",symbol:"υ"},{name:"phi",symbol:"ϕ"},{name:"chi",symbol:"χ"},{name:"psi",symbol:"ψ"},{name:"omega",symbol:"ω"}];function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function i(e){return e.charAt(0).toUpperCase()===e.charAt(0)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.TOKEN_TYPES={WHITESPACE:{name:"WHITESPACE",symbol:" ",regex:/^\s+/},BACKSLASH:{name:"BACKSLASH",symbol:"\\",regex:/^[\\\\]$/},AMPERSAND:{name:"AMPERSAND",symbol:"&",regex:/^[&]$/},OPENING_BRACE:{name:"OPENING_BRACE",symbol:null,regex:/^[\{]$/},CLOSING_BRACE:{name:"CLOSING_BRACE",symbol:null,regex:/^[\}]$/},OPENING_PARENTHESES:{name:"OPENING_PARENTHESES",symbol:null,regex:/^[\(]$/},CLOSING_PARENTHESES:{name:"CLOSING_PARENTHESES",symbol:null,regex:/^[\)]$/},OPENING_BRACKET:{name:"BRACKET",symbol:null,regex:/^[\[]$/},CLOSING_BRACKET:{name:"BRACKET",symbol:null,regex:/^[\]]$/},NUMBER_LITERAL:{name:"NUMBER_LITERAL",symbol:null,regex:/^[0-9]+$/i},STRING_LITERAL:{name:"STRING_LITERAL",symbol:null,regex:/^[a-zA-Zα-ωΑ-Ω]+$/i},OPERATOR:{name:"OPERATOR",symbol:null,regex:/^[+\-*/=^_!]$/i}}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setOptions=a,r.getOptions=function(){0===Object.keys(t).length&&t.constructor===Object&&a();return Object.assign({},t)};var t={},o=r.DEFAULTS={onlySingleVariables:!1,handleEquation:!1,addTimesSign:!0,onlyGreekName:!0,onlyGreekSymbol:!1};function a(e){t={},t=Object.assign(o,e)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MACROS_OVERRIDE=r.MACROS=void 0,r.isMacro=function(e){var r=!1;void 0!==t.get(e)&&(r=!0);return r};n(3);var t=r.MACROS=new Map([["begin",null],["end",null],["to",null],["cdot",null],["times",null],["ast",null],["div",null],["mod",null],["pm",null],["frac",null],["mathrm",null],["infty","inf"]]);r.MACROS_OVERRIDE=new Map([["cdot",{type:"operator",operatorType:"infix",value:"*"}],["times",{type:"operator",operatorType:"infix",value:"*"}],["ast",{type:"operator",operatorType:"infix",value:"*"}],["div",{type:"operator",operatorType:"infix",value:"/"}],["mod",{type:"operator",operatorType:"infix",value:"%"}],["pm",{type:"operator",operatorType:"infix",value:"+-"}]])},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handleLimitArguments=function(e){if(!(0,t.checkForVariable)(e[0]))throw new Error("Limit: variable must be a symbol");if(!(0,t.searchForOccurrence)(e[1],"value","to",!1).isPresent)throw new Error('Limit: no "to" token provided');if(void 0===e[2])throw new Error("Limit: wrong number of arguments");var r=e[0].value,n=e[2],a="";a="group"===n.type?(0,o.transpiler)(n.value):n.value;var u=i(e.slice(2));return{variable:r,value:a,direction:u}},r.isOneSidedLimit=i;var t=n(2),o=n(1),a=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0));function i(e){a.debug("Checking if limit is one sided");for(var r=!1,n="",t="",o=0;o<e.length;o++){if("group"===e[o].type){var u=i(e[o].value);!1!==u&&(r=!0,t=u)}("+"===e[o].value||"-"===e[o].value)&&o+1>=e.length&&(r=!0,n=e[o].value)}return r?(t="+"===n?"plus":"minus",a.debug("- Limit is one-sided from the "+t+" side")):a.debug("- Limit is not one-sided"),!!r&&t}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handleUpperAndLowerArgsSum=function(e){for(var r=void 0,n=void 0,o=0,a=0;a<2;a++)if("_"===e[o+a].value)r=e[++o+a];else{if("^"!==e[o+a].value)throw new Error("Finite integral must have both upper and lover limits");n="group"===e[++o+a].type?(0,t.transpiler)(e[o+a].value):e[o+a].value}return{lowerLimit:r,upperLimit:n}},r.handleLowerSumArguments=function(e){var r=e[0],n=e[1].value;if(!(0,o.checkForVariable)(r))throw new Error("Index must be a variable");if("="!==n)throw new Error("Index must be assigned. Missing equal sign");var a=e[2],i="";i="group"===a.type?(0,t.transpiler)(a.value):a.value;return{variable:r.value,value:i}};var t=n(1),o=n(2)},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.findIntegralEnd=function(e){o.debug("Finding end of integral");for(var r=1,n="",t=0;t<e.length;t++){var a=e[t].value;if(o.debug("-- Char:"+a),"function"===e[t].type&&"integral"===e[t].value)r++,o.debug("-- Found starting integral, depth "+r);else if("variable"===e[t].type&&"d"===a[0]){var i=a.match(/(d)[A-z]/g);if(null!==i&&i.length>=1){if(1===r)return n=a.substring(1),o.debug("-- Found end of original integral at position "+t),{length:t,variable:n};r--,o.debug("-- Found integral end, depth "+r)}}}throw new Error("No end of integral located")},r.handleUpperAndLowerArgs=function(e){for(var r=void 0,n=void 0,o=0,a=0;a<2;a++)if("_"===e[o+a].value)r="group"===e[++o+a].type?(0,t.transpiler)(e[o+a].value):e[o+a].value;else{if("^"!==e[o+a].value)throw new Error("Finite integral must have both upper and lower limits");n="group"===e[++o+a].type?(0,t.transpiler)(e[o+a].value):e[o+a].value}return{lowerLimit:r,upperLimit:n}};var t=n(1),o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handleMatrix=function(e){var r="";r+="matrix(";for(var n=[],o=[],a=0;a<e.length;a++){var i=e[a].value,u=e[a].type;"number"===u?o.push(i):"group"===u?o.push((0,t.transpiler)(i)):"DOUBLE_BACKSLASH"===u&&(n.push(o),o=[])}n.push(o);for(var l=n[0].length,s=0;s<n.length;s++){if(n[s].length!==l)throw new Error("All rows in matrix must be the same length");0!==s&&(r+=","),r+="["+n[s].toString()+"]"}return r+=")"};var t=n(1)},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getLimitLength=function(e){var r=0;if("group"===e[0].type&&1===e.length)r=1;else{for(var n=0,t=!1;n<e.length&&!t;)"+"!==e[n].value&&"-"!==e[n].value||(r=n,t=!0),n++;t||(r=e.length)}return r}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.environmentLength=function(e){for(var r=0,n=0;n<e.length;n++)if("environment"===e[n].type&&"begin"===e[n].state)r++,t.debug('-- Found new "begin" environment, depth '+r);else if("environment"===e[n].type&&"end"===e[n].state){if(1===r)return t.debug("-- Found original environment end at position "+n),n-1;r--,t.debug('-- Found environment "end", depth '+r)}throw new Error('Environments "begin" and "end" doesn\'t match up')};var t=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.RESERVED_WORDS={INTEGRATION_END:{name:"INTEGRATION_END",symbol:null,regex:/(d)[A-z]/,type:"integral_end"}}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.environments=["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","smallmatrix"]},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.functions=["sin","cos","tan","arcsin","arccos","arctan","log","ln","sqrt","max","min","sum","lim","int","binom"]},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseLatex=function e(r){var n=(0,l.getOptions)();s.debug("\n------------------ PARSING -> -------------------");var d=0;var g=[];function b(e){g.push(e)}function m(){return s.debug("Consuming position: "+d),r[d++].value}function y(){return s.debug("Skip token at position: "+d),r[d++].value}function h(){return r[d]?r[d].value:void 0}function E(){return r[d+1]?r[d+1].type.name:null}function w(){return s.debug("- Single number"),{type:"number",value:m()}}function S(){s.debug("Parsing number: "+r[d].value);var e=E(),n=function(){var e=r[d-1];return e?e.value:null}(),t=function(e){var r=g[g.length-e];return r?r.type:null}(1);if("^"!==n&&"_"!==n&&"function"!==t){if(null!==e&&e===i.TOKEN_TYPES.NUMBER_LITERAL.name){s.debug('- Found another number "'+r[d+1].value+'", continuing parsing');var o=w().value+L().value;return{type:"number",value:o}}return w()}return w()}function O(){s.debug('- Found letter "'+h()+'"');var e="";return E()===i.TOKEN_TYPES.STRING_LITERAL.name?(s.debug(", continuing parsing"),e=m()+O(i.TOKEN_TYPES.STRING_LITERAL.name),s.debug("current word: "+e)):e=m(),s.debug("current sequence: "+e),e}function _(){s.debug("Parsing variable: "+r[d].value);var e="",t=d;if(e=O(),s.debug("current word: "+e),function(e){var r=!1;for(var n in s.debug("Checking "+e+" for reserved word"),u.RESERVED_WORDS)if(u.RESERVED_WORDS.hasOwnProperty(n)){var t=u.RESERVED_WORDS[n].regex;t.test(e)&&(r=!0)}return r}(e)){s.debug("Variable contains reserved words");var o=void 0,a=function(e){var r="",n="";for(var t in u.RESERVED_WORDS)if(u.RESERVED_WORDS.hasOwnProperty(t)){var o=u.RESERVED_WORDS[t].regex;if(null!==e.match(o)){r=u.RESERVED_WORDS[t].type,n=o.exec(e);break}}return{type:r,value:n}}(e),i=a.value;o=i[0].length,s.debug("reserved word: "+i[0]+", length: "+o+", index "+i.index),i.index>0?(d=t+i.index,e=e.substr(0,i.index),n.onlySingleVariables&&(d=t,e=m())):(d=t+o,e=i[0])}else n.onlySingleVariables&&(d=t,e=m());return{type:"variable",value:e}}function T(){var t="";switch(h()){case v:t="curly";break;case c:t="normal";break;case p:t="square"}var o=function(e,r){s.debug("Finding matching bracket");var n="",t="";switch(r){case"normal":n="(",t=")";break;case"curly":n="{",t="}";break;case"square":n="[",t="]"}for(var o=0,a=0;a<e.length;a++){var i=e[a].value;if(s.debug("-- Char:"+i),i===n)o++,s.debug("-- Found starting bracket, depth "+o);else if(i===t){if(1===o)return s.debug("-- Found original closing bracket at position "+a),a;o--,s.debug("-- Found closing bracket, depth "+o)}}throw new Error("Brackets do not match up")}(r.slice(d),t);if(o instanceof Error)return o;var a=r.slice(d+1,d+o);return s.debug("New group created"),d+=o+1,{type:"group",symbol:t,value:e(a,n)}}function x(e){if(h()!==v)throw new Error("No argument for environments are present.");y();var r=O();if(y(),function(e){var r=a.environments.reduce(function(r,n){return r||n===e},!1);return s.debug("Is acknowledged environment?: "+r),r}(r)){if("begin"===e||"end"===e)return{type:"environment",state:e,value:r};throw new Error("environment state "+e+" is not valid")}throw new Error("Environment type "+r+" is not supported")}function A(){s.debug("Found backslash");if(E()===i.TOKEN_TYPES.BACKSLASH.regex)return{type:"DOUBLE_BACKSLASH",value:m()+m()};if(d++,void 0===h())return null;if(function(e){var r=!1;return[" ","{","}","\\"].forEach(function(n){e===n&&(r=!0,s.debug(e+" is special char"))}),r}(h()))return function(e){var r=null;switch(e){case" ":r=null;break;case"{":r=T();break;case"}":r=null;break;case"\\":r={type:"DOUBLE_BACKSLASH",value:m()+m()};break;default:return!1}return r}(h());var e=O();return"begin"===e?x("begin"):"end"===e?x("end"):function(e){return t.functions.reduce(function(r,n){return r||n===e},!1)}(e)?function(e){var r={};switch(e){case"int":r={type:"function",value:"integral"};break;default:r={type:"function",value:e}}return r}(e):function(e){var r=null,n=(0,o.isMacro)(e),t=(0,f.isGreekLetter)(e);n?void 0===(r=o.MACROS_OVERRIDE.get(e))&&(r={type:"token",value:e}):t?r={type:"token",value:e}:s.warn('Encountered an unsupported macro "'+e+'", ignoring..');return r}(e)}function L(){var e=null,n=r[d];switch(n.type){case i.TOKEN_TYPES.NUMBER_LITERAL:s.debug('Found NUMBER_LITERAL "'+h()+'"'),e=S();break;case i.TOKEN_TYPES.BACKSLASH:s.debug('Found BACKSLASH "'+h()+'"'),e=A();break;case i.TOKEN_TYPES.OPERATOR:s.debug('Found OPERATOR "'+h()+'"'),e=function(){s.debug("Found operator");var e=r[d];if(/^[+\-*/=^_]$/i.test(e.value))return{type:"operator",operatorType:"infix",value:m()};if(/^[]$/i.test(e.value))return{type:"operator",operatorType:"prefix",value:m()};if(/^[!]$/i.test(e.value))return{type:"operator",operatorType:"postfix",value:m()}}();break;case i.TOKEN_TYPES.STRING_LITERAL:s.debug('Found STRING_LITERAL "'+h()+'"'),e=_();break;case i.TOKEN_TYPES.OPENING_BRACE:case i.TOKEN_TYPES.OPENING_PARENTHESES:case i.TOKEN_TYPES.OPENING_BRACKET:s.debug('Found BRACKET "'+h()+'"'),e=T();break;default:d++}return e}return function(){var e=0;for(;d<r.length;){s.debug("--------- Parsing next token. While loop run: "+e+" ---------");var n=L();if(null!==n){if(void 0===n)throw d=r.length,new Error("node is undefined");if(b(n),s.debug("Parsed result type: "+n.type),++e>1e3)throw new Error("Max count reached, infinite loop encountered.")}}return s.debug("--------- End of while loop. Tokens position: "+(d-1)+" of "+(r.length-1)+" ---------"),g}()};var t=n(15),o=n(6),a=n(14),i=n(4),u=n(13),l=n(5),s=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0)),f=n(3);var v="{",c="(",p="["},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.Token=function e(r,n){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=n,this.type=r}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.lex=function(e){var r=0,n=[],i=function(e){return n.push(e)},u=function(){return n};function l(){return a.debug("Consuming position: "+r+", char: "+e[r]),e[r++]}function s(e){if(void 0===e)return null;for(var r in t.TOKEN_TYPES)if(t.TOKEN_TYPES.hasOwnProperty(r)){var n=t.TOKEN_TYPES[r],o=n.regex;if(e.match(o))return n}return null}return function(){a.debug("\n------------------ LEXICAL ANALYSIS -> -------------------");for(;r<e.length;){var n=void 0,t="",f=s(e[r]);t=l(),void 0!==(n=new o.Token(f,t))&&i(n)}return u()}()};var t=n(4),o=n(17),a=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.scan=function(e){var r=[];function n(e){r.push(e)}o.debug("\n------------------ SCANNER -> -------------------");var a=0;for(;a<e.length;){for(var i in t.TOKEN_TYPES)t.TOKEN_TYPES.hasOwnProperty(i)&&e[a].match(t.TOKEN_TYPES[i].regex)&&n(e[a]);a++}return r};var t=n(4),o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TeX2Max=void 0;var t=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0)),a=n(5),i=n(19),u=n(18),l=n(16),s=n(1),f=n(2);r.TeX2Max=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),(0,a.setOptions)(r),this.options=(0,a.getOptions)(),this.lastInput="",this.lastResult=""}return t(e,[{key:"getLastInput",value:function(){return this.lastInput()}},{key:"getLastResult",value:function(){return this.lastResult}},{key:"toMaxima",value:function(e){(0,a.setOptions)(this.options);var r=void 0;this.lastInput=e;var n=(0,i.scan)(e);o.debug(n);var t=(0,u.lex)(n);o.debug(t),this.structure=(0,l.parseLatex)(t),o.debug(this.structure);var v=(0,s.transpiler)(this.structure);return r=(0,f.stripParenthesis)(v),this.options.handleEquation&&(0,f.isEquation)(this.structure)&&(r="solve("+r+")"),this.lastResult=r,r}}]),e}()}])});